---
layout: post
title: X-RAIL: Our Multi-Agent Insurance AI Platform Built with Google Cloud & ADK
description: How we built X-RAIL — an explainable, multi-agent AI system for insurance risk analysis and automation using Google Cloud and the Agent Development Kit (ADK).
date: 2025-06-23 21:00:00 +0530
image: "/img/posts/xrail/XRAIL22.png"
tags: [Google Cloud, ADK, Insurance AI, Explainable AI, Multi-Agent Systems, Vertex AI, SHAP, BigQuery]
---

# 🚂 Building X-RAIL: A Multi-Agent AI Insurance Platform Powered by Google Cloud & ADK

> “A claim comes in. Multiple AI agents collaborate, reason, explain, and simulate outcomes — all within seconds. The underwriter sees a full dashboard. The customer gets an understandable explanation. And regulators see a compliant audit trail.”  
> — That’s the promise of **X-RAIL**.

---

## 🧠 The Problem We Set Out to Solve

Insurance underwriting today is often powered by black-box models. While these models are powerful, they lack transparency — a huge risk in an industry regulated by compliance mandates and trust.

In 2023 alone, the global insurance industry wrote approximately **$7 trillion in premiums**. As regulation tightens around AI explainability, we asked:  
**How might we bring transparency, trust, and automation to the heart of the insurance process?**

---

## ✨ Enter X-RAIL

We created **X-RAIL** — **X**plainable **R**isk **A**ssessment & **I**nsights **L**oop — a fully modular, explainable, multi-agent AI platform for insurance risk analysis and automation.

Built on **Google Cloud** and **Google’s Agent Development Kit (ADK)**, X-RAIL simulates an entire underwriting team — but faster, smarter, and always explainable.

X-RAIL isn’t just a model. It’s an entire system of AI agents that:

- Compute risk scores from incoming claims
- Explain every prediction
- Simulate "what-if" scenarios
- Generate dashboards and reports
- Train models on demand
- Run analytics with natural language

---

## 🧱 Architecture & Agents

We broke down the underwriting pipeline into modular agents, each responsible for a specific task. These agents are orchestrated using ADK’s multi-agent framework and persistent `tool_context` state.

### Core Agents:

- **🧠 Conductor Agent**  
  The root agent that routes tasks based on intent and session state.

- **🔢 Risk Agent**  
  Predicts calibrated risk scores using XGBoost and isotonic calibration — hosted on Vertex AI with SHAP-based explainability.

- **🔍 Explainability Agent**  
  Generates audit-compliant SHAP explanations, with both technical and plain-language options.

- **📊 Dashboard Agent**  
  Creates Streamlit dashboards visualizing risk scores, SHAP plots, simulation deltas, and metadata.

- **🔁 Impact Simulator Agent**  
  Runs real-time "what-if" simulations — e.g., income change, new car — and shows premium impact with recommendations.

- **📈 BQML Agent**  
  Trains and evaluates BigQuery ML models on user request, with model comparison and feature analysis.

- **🧮 BigQuery Agent**  
  Converts natural language to SQL using ChaseSQL and queries policy/claim data from BigQuery.

- **📈 Analytics Agent**  
  Runs advanced Python-based analytics, charts, and statistical analysis using Vertex AI Code Executor.

---

## ⚙️ The Tech Stack

| Layer                  | Tech Used                    |
| ---------------------- | ---------------------------- |
| **Core Orchestration** | Google ADK, Gemini 2.0 Flash |
| **Model Hosting**      | Vertex AI, BQML              |
| **Explainability**     | SHAP, Scikit-learn           |
| **Data Handling**      | BigQuery, Pandas, NumPy      |
| **Visualization**      | Streamlit, Matplotlib        |
| **UI & Reports**       | FPDF, Streamlit              |
| **Storage**            | Google Cloud Storage         |
| **DevOps**             | Docker, Cloud Run, Poetry    |
| **Security**           | Google IAM, audit logging    |
| **Testing**            | Pytest, IPython              |

---

## 🛠️ Key Features

- ✅ **Risk Scoring** with confidence intervals
- ✅ **Regulatory Explainability** with top features from SHAP
- ✅ **Real-Time Simulations** with multi-scenario comparison
- ✅ **NL to SQL & Python** for analytics and querying
- ✅ **On-demand BQML model training and tuning**
- ✅ **Interactive Dashboards + PDF Reports**
- ✅ **Full Audit Trails**: input hashing, session logs, traceability

---

## 🔄 Agent Interactions: How It All Comes Together

Gemini routes tasks intelligently, leveraging ADK’s context persistence to maintain shared state. Agents interact through a unified state (`tool_context.state`) that holds input data, risk scores, explanations, simulation metadata, and more.

From intake to explanation to simulation — the entire decision-making loop is automated, explainable, and auditable.

---

## 🧪 Challenges We Faced

### 1. Multi-Agent State Management

Coordinating multiple agents across workflows was tough. We solved it with persistent session state via ADK's callback context and rigorous interface design.

### 2. Lack of Real Insurance Data

We built a **Python-based data engine** that generated:

- 100K synthetic customer records
- 50K realistic claims
- 100K policy entries  
  All statistically realistic, with outliers and controlled noise.

### 3. Deployment Complexity

Deploying a distributed, agent-heavy architecture on Cloud Run took effort. Docker + Poetry helped isolate environments, and custom entrypoints simplified startup.

### 4. SHAP Interpretability

We invested time translating SHAP plots into regulatory-aligned, human-readable summaries — not just technical explanations.

---

## 🏆 Accomplishments

- ✅ Full-stack, explainable AI pipeline for insurance
- ✅ Automated risk predictions with complete audit trail
- ✅ Seamless NL inputs for both technical and non-technical users
- ✅ Real-time dashboards and reports
- ✅ Extensible to fraud, telematics, and compliance agents

---

## 💡 Lessons Learned

- Multi-agent systems require careful task decomposition and input/output standardization.
- Transparency is _non-negotiable_ in regulated industries.
- Google ADK is a powerful backbone for orchestrating LLM + task agents.
- Data simulation is a powerful stand-in when real-world data is inaccessible.
- Auditability builds **trust** — not just compliance.

---

## 🔮 What’s Next

- 🛡️ **Fraud Detection Agent**
- 📱 **Mobile-first App for Agents & Customers**
- 📦 **Portfolio-Level Simulation Engine**
- 🧾 **Regulatory Mapping Agent** for legal traceability
- 🚗 **Telematics Integration** for dynamic pricing
- 🔁 **Counterfactual Reasoning**: "What could’ve improved this score?"

---

## 📊 Real-World Impact

X-RAIL helps insurers:

- Cut manual review time by up to **70%**
- Build **trust** through explainable AI
- Stay compliant with laws like the **EU AI Act**
- Support underwriters with **simulations**, **dashboards**, and **recommendations**

---

## 💬 Final Thoughts

Building X-RAIL was a deep dive into what it means to make AI **transparent**, **modular**, and **actionable**. We didn’t just build another ML pipeline — we built a **collaborative, intelligent agent system** that mirrors real-world decision-making with speed, explainability, and trust.

It’s not just AI.  
It’s AI you can understand, explain — and **trust**.

---
